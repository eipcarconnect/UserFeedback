<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Index</title>
</head>
<body>
    <p>Trier les commentaires par :
        <select>
            <option value="date">Date de publication</option>
            <option value="user">Utilisateur</option>
            <option value="platform">Platforme</option>
            <option value="rate">Note</option>
            <option value="message">Message</option>
        </select>
    </p>
    <h2>Commentaires</h2>
        La satifaction moyenne est de: <span id="nbComs"></span> / 5
    <ul id="commentaires">

    </ul>

    <script>
        api_url = "http://127.0.0.1:4242/"

        getAverageSatisfaction()
        getComments()

        function getAverageSatisfaction() {
            let xmlHttp = new XMLHttpRequest()
            xmlHttp.onload = function () {
                let data = JSON.parse(this.responseText)
                document.getElementById("nbComs").innerHTML = data["data"]
            }
            xmlHttp.open( "GET", api_url + "average_satisfaction", true )
            xmlHttp.send( null )
        }

        function getComments() {
            let xmlHttp = new XMLHttpRequest()
            xmlHttp.onload = function () {
                let data = JSON.parse(this.responseText)
                let parent = document.getElementById('commentaires')
                for (let i = 0; i < data["users"].length; ++i) {
                    let newChild = document.createElement('p')
                    newChild.textContent = data["users"][i] + ":\t" + data["messages"][i]
                    parent.appendChild(newChild)
                }
            }
            xmlHttp.open( "GET", api_url + "client_comments", true )
            xmlHttp.send( null )
        }

    </script>
</body>
</html>